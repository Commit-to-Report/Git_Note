{"version":3,"file":"network-status.js","sourceRoot":"","sources":["../../lambda_functions/network-status.ts"],"names":[],"mappings":"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","sourcesContent":["// lambda_functions/network-status.ts\nimport { APIGatewayProxyHandler } from 'aws-lambda';\nimport * as AWS from 'aws-sdk';\n\n// AWS SDK 클라이언트 초기화\nconst ec2 = new AWS.EC2({ region: 'ap-northeast-2' });\nconst elbv2 = new AWS.ELBv2({ region: 'ap-northeast-2' });\n\n/**\n * GitNote Network Status Lambda Handler\n * VPC, Subnets, NAT Gateway, ALB 상태를 동적으로 조회\n */\nexport const handler: APIGatewayProxyHandler = async (event) => {\n    console.log('Network Status Request:', JSON.stringify(event));\n    \n    try {\n        // 병렬로 네트워크 리소스 조회\n        const [vpcData, albData, natGatewayData] = await Promise.all([\n            getVPCStatus(),\n            getALBStatus(),\n            getNATGatewayStatus()\n        ]);\n        \n        // 이상 징후 감지\n        const alerts = detectNetworkIssues(vpcData, albData, natGatewayData);\n        \n        // 응답 구성\n        const response = {\n            resources: [\n                ...vpcData,\n                ...albData,\n                ...natGatewayData\n            ],\n            alerts,\n            timestamp: new Date().toISOString()\n        };\n        \n        return {\n            statusCode: 200,\n            headers: {\n                'Content-Type': 'application/json',\n                'Access-Control-Allow-Origin': '*',\n                'Access-Control-Allow-Headers': 'Content-Type',\n                'Access-Control-Allow-Methods': 'GET, OPTIONS'\n            },\n            body: JSON.stringify(response)\n        };\n        \n    } catch (error) {\n        console.error('Error in network-status handler:', error);\n        \n        return {\n            statusCode: 500,\n            headers: {\n                'Content-Type': 'application/json',\n                'Access-Control-Allow-Origin': '*'\n            },\n            body: JSON.stringify({\n                error: 'Failed to retrieve network status',\n                message: error instanceof Error ? error.message : 'Unknown error',\n                timestamp: new Date().toISOString()\n            })\n        };\n    }\n};\n\n/**\n * VPC 및 서브넷 상태 조회\n */\nasync function getVPCStatus(): Promise<any[]> {\n    const resources: any[] = [];\n    \n    try {\n        // VPC 조회 - Name 태그로 필터링\n        const vpcs = await ec2.describeVpcs({\n            Filters: [\n                {\n                    Name: 'tag:Name',\n                    Values: ['gitnote-vpc']\n                }\n            ]\n        }).promise();\n        \n        if (vpcs.Vpcs && vpcs.Vpcs.length > 0) {\n            const vpc = vpcs.Vpcs[0];\n            \n            // 서브넷 조회\n            const subnets = await ec2.describeSubnets({\n                Filters: [\n                    {\n                        Name: 'vpc-id',\n                        Values: [vpc.VpcId!]\n                    }\n                ]\n            }).promise();\n            \n            // Internet Gateway 조회\n            const igws = await ec2.describeInternetGateways({\n                Filters: [\n                    {\n                        Name: 'attachment.vpc-id',\n                        Values: [vpc.VpcId!]\n                    }\n                ]\n            }).promise();\n            \n            resources.push({\n                name: 'gitnote-vpc',\n                type: 'VPC',\n                status: vpc.State === 'available' ? 'healthy' : 'warning',\n                details: {\n                    'VPC ID': vpc.VpcId,\n                    'CIDR Block': vpc.CidrBlock,\n                    'Subnets': subnets.Subnets?.length || 0,\n                    'Internet Gateway': igws.InternetGateways?.length > 0 ? 'Attached' : 'Not Attached',\n                    'State': vpc.State\n                }\n            });\n            \n            // 서브넷 상태 확인\n            const publicSubnets = subnets.Subnets?.filter(s => \n                s.MapPublicIpOnLaunch === true\n            ).length || 0;\n            \n            const privateSubnets = (subnets.Subnets?.length || 0) - publicSubnets;\n            \n            if (publicSubnets > 0) {\n                resources.push({\n                    name: 'Public Subnets',\n                    type: 'Subnet',\n                    status: 'healthy',\n                    details: {\n                        'Count': publicSubnets,\n                        'Auto-assign Public IP': 'Enabled'\n                    }\n                });\n            }\n            \n            if (privateSubnets > 0) {\n                resources.push({\n                    name: 'Private Subnets',\n                    type: 'Subnet',\n                    status: 'healthy',\n                    details: {\n                        'Count': privateSubnets,\n                        'Type': 'Private'\n                    }\n                });\n            }\n        }\n        \n    } catch (error) {\n        console.error('Error getting VPC status:', error);\n        resources.push({\n            name: 'gitnote-vpc',\n            type: 'VPC',\n            status: 'critical',\n            details: {\n                'Error': 'Failed to retrieve VPC information'\n            }\n        });\n    }\n    \n    return resources;\n}\n\n/**\n * Application Load Balancer 상태 조회\n */\nasync function getALBStatus(): Promise<any[]> {\n    const resources: any[] = [];\n    \n    try {\n        // ALB 조회 - Name으로 필터링\n        const loadBalancers = await elbv2.describeLoadBalancers({\n            Names: ['gitnote-alb']\n        }).promise();\n        \n        if (loadBalancers.LoadBalancers && loadBalancers.LoadBalancers.length > 0) {\n            const alb = loadBalancers.LoadBalancers[0];\n            \n            // Target Group 조회\n            const targetGroups = await elbv2.describeTargetGroups({\n                LoadBalancerArn: alb.LoadBalancerArn\n            }).promise();\n            \n            // Target Health 조회\n            let healthyTargets = 0;\n            let unhealthyTargets = 0;\n            \n            if (targetGroups.TargetGroups && targetGroups.TargetGroups.length > 0) {\n                for (const tg of targetGroups.TargetGroups) {\n                    const health = await elbv2.describeTargetHealth({\n                        TargetGroupArn: tg.TargetGroupArn\n                    }).promise();\n                    \n                    health.TargetHealthDescriptions?.forEach(thd => {\n                        if (thd.TargetHealth?.State === 'healthy') {\n                            healthyTargets++;\n                        } else {\n                            unhealthyTargets++;\n                        }\n                    });\n                }\n            }\n            \n            const albStatus = alb.State?.Code === 'active' && healthyTargets > 0 ? 'healthy' :\n                             unhealthyTargets > 0 ? 'warning' : 'critical';\n            \n            resources.push({\n                name: 'gitnote-alb',\n                type: 'Application Load Balancer',\n                status: albStatus,\n                details: {\n                    'DNS Name': alb.DNSName,\n                    'State': alb.State?.Code,\n                    'Type': alb.Type,\n                    'Scheme': alb.Scheme,\n                    'Availability Zones': alb.AvailabilityZones?.length || 0,\n                    'Healthy Targets': healthyTargets,\n                    'Unhealthy Targets': unhealthyTargets\n                }\n            });\n            \n            // Target Group 정보\n            if (targetGroups.TargetGroups && targetGroups.TargetGroups.length > 0) {\n                const tg = targetGroups.TargetGroups.find(t => \n                    t.TargetGroupName === 'gitnote-tg'\n                ) || targetGroups.TargetGroups[0];\n                \n                resources.push({\n                    name: tg.TargetGroupName || 'Target Group',\n                    type: 'Target Group',\n                    status: healthyTargets > 0 ? 'healthy' : 'critical',\n                    details: {\n                        'Protocol': tg.Protocol,\n                        'Port': tg.Port,\n                        'Target Type': tg.TargetType,\n                        'Health Check Path': tg.HealthCheckPath || '/',\n                        'Healthy/Total': `${healthyTargets}/${healthyTargets + unhealthyTargets}`\n                    }\n                });\n            }\n        }\n        \n    } catch (error) {\n        console.error('Error getting ALB status:', error);\n        \n        // ALB가 없거나 접근 불가한 경우\n        if ((error as any).code === 'LoadBalancerNotFound') {\n            resources.push({\n                name: 'gitnote-alb',\n                type: 'Application Load Balancer',\n                status: 'warning',\n                details: {\n                    'Status': 'Not Found',\n                    'Message': 'ALB not deployed or name mismatch'\n                }\n            });\n        } else {\n            resources.push({\n                name: 'gitnote-alb',\n                type: 'Application Load Balancer',\n                status: 'critical',\n                details: {\n                    'Error': 'Failed to retrieve ALB information'\n                }\n            });\n        }\n    }\n    \n    return resources;\n}\n\n/**\n * NAT Gateway 상태 조회\n */\nasync function getNATGatewayStatus(): Promise<any[]> {\n    const resources: any[] = [];\n    \n    try {\n        // NAT Gateway 조회\n        const natGateways = await ec2.describeNatGateways({\n            Filter: [\n                {\n                    Name: 'state',\n                    Values: ['available', 'pending', 'failed']\n                }\n            ]\n        }).promise();\n        \n        if (natGateways.NatGateways && natGateways.NatGateways.length > 0) {\n            natGateways.NatGateways.forEach(nat => {\n                const status = nat.State === 'available' ? 'healthy' :\n                              nat.State === 'pending' ? 'warning' : 'critical';\n                \n                resources.push({\n                    name: `NAT Gateway (${nat.SubnetId})`,\n                    type: 'NAT Gateway',\n                    status,\n                    details: {\n                        'NAT Gateway ID': nat.NatGatewayId,\n                        'State': nat.State,\n                        'Public IP': nat.NatGatewayAddresses?.[0]?.PublicIp || 'N/A',\n                        'Private IP': nat.NatGatewayAddresses?.[0]?.PrivateIp || 'N/A',\n                        'Subnet': nat.SubnetId\n                    }\n                });\n            });\n        } else {\n            resources.push({\n                name: 'NAT Gateway',\n                type: 'NAT Gateway',\n                status: 'warning',\n                details: {\n                    'Status': 'Not Found',\n                    'Message': 'No NAT Gateway configured'\n                }\n            });\n        }\n        \n    } catch (error) {\n        console.error('Error getting NAT Gateway status:', error);\n    }\n    \n    return resources;\n}\n\n/**\n * 네트워크 이상 징후 감지\n */\nfunction detectNetworkIssues(vpcData: any[], albData: any[], natData: any[]): any[] {\n    const alerts: any[] = [];\n    \n    // VPC 이슈 확인\n    const vpcIssue = vpcData.find(r => r.status !== 'healthy');\n    if (vpcIssue) {\n        alerts.push({\n            severity: 'danger',\n            title: 'VPC Configuration Issue',\n            message: `VPC ${vpcIssue.name} is in ${vpcIssue.status} state. Check network configuration.`,\n            timestamp: new Date().toISOString()\n        });\n    }\n    \n    // ALB 타겟 헬스 체크\n    const albResource = albData.find(r => r.type === 'Application Load Balancer');\n    if (albResource && albResource.details['Unhealthy Targets'] > 0) {\n        alerts.push({\n            severity: 'warning',\n            title: 'Unhealthy ALB Targets Detected',\n            message: `${albResource.details['Unhealthy Targets']} unhealthy targets in ALB. Services may be experiencing issues.`,\n            timestamp: new Date().toISOString()\n        });\n    }\n    \n    // NAT Gateway 이슈 확인\n    const natIssue = natData.find(r => r.status === 'critical');\n    if (natIssue) {\n        alerts.push({\n            severity: 'danger',\n            title: 'NAT Gateway Failure',\n            message: 'NAT Gateway is in failed state. Private subnets cannot access internet.',\n            timestamp: new Date().toISOString()\n        });\n    }\n    \n    return alerts;\n}"]}